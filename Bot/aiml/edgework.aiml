<?xml version='1.0' encoding='UTF-8'?>
<aiml version='2.1'>
	<category>
		<pattern>ClearEdgework</pattern>
		<template>
			<think>
				<set name='BatteryHolderCount'>0</set>
				<set name='BatteryCount'>0</set>

				<condition name='Indicators'>
					<li value='nil'></li>
					<li>
						<set><name>Indicator<first><get name='Indicators'/></first>Lit</name>unknown</set>
						<set name='Indicators'><rest><get name='Indicators'/></rest></set>
						<loop/>
					</li>
				</condition>
				<set name='IndicatorCount'>0</set>
				<set name='IndicatorUnlitCount'>0</set>
				<set name='IndicatorLitCount'>0</set>

				<set name='PortPlateCount'>0</set>
				<set name='PortEmptyPlate'>false</set>
				<set name='PortCount'>0</set>
				<set name='PortCountSerial'>0</set>
				<set name='PortCountParallel'>0</set>
				<set name='PortCountDVID'>0</set>
				<set name='PortCountRJ45'>0</set>
				<set name='PortCountStereoRCA'>0</set>
				<set name='PortCountPS2'>0</set>
				<set name='PortSerial'>false</set>
				<set name='PortParallel'>false</set>
				<set name='PortDVID'>false</set>
				<set name='PortRJ45'>false</set>
				<set name='PortStereoRCA'>false</set>
				<set name='PortPS2'>false</set>

				<set name='SerialNumber'>unknown</set>
				<set name='SerialNumberHasVowel'>unknown</set>
				<set name='SerialNumberIsOdd'>unknown</set>
				<set name='SerialNumber1IsLetter'>unknown</set>
				<set name='SerialNumber2IsLetter'>unknown</set>
			</think>
		</template>
	</category>

	<!-- Usage: RegisterWidget [screenshot token] XS [points] -->
	<category>
		<pattern>RegisterWidget * XS *</pattern>
		<template>
			<think>
				<set var='widgetType'><sraix service='BombDefuserAimlService'>IdentifyWidget <star/> <star index='2'/></sraix></set>
				<set var='data'><condition var='widgetType'><li value='nil'>nil</li><li><sraix service='BombDefuserAimlService'><get var='widgetType'/> <star/> <star index='2'/></sraix></li></condition></set>
				<gossip>RegisterWidget: <get var='widgetType'/> - <get var='data'/></gossip>
				<condition var='widgetType'>
					<li value='BatteryHolder'>
						<set name='BatteryHolderCount'><map name='successor'><get name='BatteryHolderCount'/></map></set>
						<condition var='data'>
							<li value='0'></li>
							<li>
								<set name='BatteryCount'><map name='successor'><get name='BatteryCount'/></map></set>
								<set var='data'><map name='predecessor'><get var='data'/></map></set>
								<loop/>
							</li>
						</condition>
					</li>
					<li value='Indicator'>
						<set name='IndicatorCount'><map name='successor'><get name='IndicatorCount'/></map></set>
						<set var='lightState'><first><get var='data'/></first></set>
						<set var='label'><rest><get var='data'/></rest></set>
						<set name='Indicators'><srai>XAppend <get var='label'/> XS <get name='Indicators'/></srai></set>
						<set><name>Indicator<get var='label'/>Lit</name><condition var='lightState'><li value='lit'>true</li><li>false</li></condition></set>
						<set><name>Indicator<get var='lightState'/>Count</name><map name='successor'><get><name>Indicator<get var='lightState'/>Count</name></get></map></set>
					</li>
					<li value='PortPlate'>
						<set name='PortPlateCount'><map name='successor'><get name='PortPlateCount'/></map></set>
						<set><name>PortPlate<get name='PortPlateCount'/></name><get var='data'/></set>
						<condition var='data'>
							<li value='nil'>
								<set name='PortEmptyPlate'>true</set>
							</li>
							<li>
								<condition var='data'>
									<li value='nil'></li>
									<li>
										<set var='port'><first><get var='data'/></first></set>
										<set var='data'><rest><get var='data'/></rest></set>
										<set><name>Port<get var='port'/></name>true</set>
										<set><name>Port<get var='port'/>Count</name><map name='successor'><get><name>Port<get var='port'/>Count</name></get></map></set>
										<loop/>
									</li>
								</condition>
							</li>
						</condition>
					</li>
					<li value='SerialNumber'>
						<set name='SerialNumber'><get var='data'/></set>
						<set var='chars'><explode><get var='data'/></explode></set>
						<set var='i'>1</set>
						<condition var='chars'>
							<li value='nil'></li>
							<li>
								<set var='char'><first><get var='chars'/></first></set>
								<set var='chars'><rest><get var='chars'/></rest></set>
								<set var='isDigit'><srai>XIsNumber <get var='char'/></srai></set>
								<condition var='isDigit'>
									<li value='true'>
										<set><name>SerialNumber<get var='i'/>IsLetter</name>false</set>
										<condition var='char'>
											<li value='1'><set name='SerialNumberIsOdd'>true</set></li>
											<li value='3'><set name='SerialNumberIsOdd'>true</set></li>
											<li value='5'><set name='SerialNumberIsOdd'>true</set></li>
											<li value='7'><set name='SerialNumberIsOdd'>true</set></li>
											<li value='9'><set name='SerialNumberIsOdd'>true</set></li>
										</condition>
									</li>
									<li>
										<set><name>SerialNumber<get var='i'/>IsLetter</name>true</set>
										<condition var='char'>
											<li value='A'><set name='SerialNumberHasVowel'>true</set></li>
											<li value='E'><set name='SerialNumberHasVowel'>true</set></li>
											<li value='I'><set name='SerialNumberHasVowel'>true</set></li>
											<li value='O'><set name='SerialNumberHasVowel'>true</set></li>
											<li value='U'><set name='SerialNumberHasVowel'>true</set></li>
										</condition>
									</li>
								</condition>
								<set var='i'><map name='successor'><get var='i'/></map></set>
								<loop/>
							</li>
						</condition>
					</li>
				</condition>
			</think>
		</template>
	</category>

	<category>
		<pattern>edgework</pattern>
		<template>
			<condition name='BatteryCount'>
				<li value='0'>No batteries.</li>
				<li>
					<get name='BatteryCount'/> <condition name='BatteryCount'><li value='1'>battery</li><li>batteries</li></condition>
					in <get name='BatteryHolderCount'/> <condition name='BatteryHolderCount'><li value='1'>holder</li><li>holders</li></condition>.
				</li>
			</condition>
			<condition name='Indicators'>
				<li value='nil'>No indicators.</li>
				<li>
					Indicators:
					<think><set var='indicators'><get name='Indicators'/></set></think>
					<condition var='indicators'>
						<li value='nil'></li>
						<li>
							<think>
								<set var='label'><first><get var='indicators'/></first></set>
								<set var='indicators'><rest><get var='indicators'/></rest></set>
							</think>
							<condition><name>Indicator<get var='label'/>Lit</name>
								<li value='true'>Lit</li>
								<li>Unlit</li>
							</condition>
							<srai>SpeakNato <get var='label'/></srai>;
							<loop/>
						</li>
					</condition>.
				</li>
			</condition>
			<condition name='PortPlateCount'>
				<li value='0'>No ports.</li>
				<li>
					Ports:
					<think>
						<set var='break'>false</set>
						<set var='i'>1</set>
						<set var='emptyCount'>0</set>
					</think>
					<condition var='break' value='false'>
						<condition var='i'><li value='1'></li><li>;</li></condition>
						<think>
							<set var='ports'><get><name>PortPlate<get var='i'/></name></get></set>
							<set var='any'>false</set>
						</think>
						<condition var='ports'>
							<li value='nil'><think><set var='emptyCount'><map name='successor'><get var='emptyCount'/></map></set></think></li>
							<li>
								port plate:
								<condition var='ports'>
									<li value='nil'></li>
									<li><condition var='any' value='true'>,</condition>
										<think>
											<set var='any'>true</set>
											<set var='port'><first><get var='ports'/></first></set>
											<set var='ports'><rest><get var='ports'/></rest></set>
										</think>
										<map name='PortDescription'><get var='port'/></map>
										<loop/>
									</li>
								</condition>
							</li>
						</condition>
						<think>
							<condition var='i'>
								<li><value><get name='PortPlateCount'/></value><set var='break'>true</set></li>
								<li><set var='i'><map name='successor'><get var='i'/></map></set></li>
							</condition>
						</think>
						<loop/>
					</condition>
					<condition var='emptyCount'>
						<li value='0'>.</li>
						<li value='1'>; an empty port plate.</li>
						<li>; <get var='emptyCount'/> empty port plates.</li>
					</condition>
				</li>
			</condition>
			Serial number: <srai>SpeakNato <get name='SerialNumber'/></srai>
		</template>
	</category>
</aiml>
